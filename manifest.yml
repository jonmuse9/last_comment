modules:
  trigger:
    - key: flowzira-comment-event-trigger
      function: handelEvent
      events:
        - avi:jira:commented:issue
        - avi:jira:deleted:comment
  jira:customField:
    - key: flowzira-last-comment-custom-field
      name: Flowzira Last Comment
      description: Displays the content of the last comment on the issue.
      type: string
      view:
        value:
          function: get-last-comment
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-comment-count-custom-field
      name: Flowzira Comment Count
      description: The total number of comments on the issue.
      type: number
      view:
        value:
          function: getCommentCount
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-internal-comment-count-custom-field
      name: Flowzira Internal Comment Count
      description: The number of internal comments on the issue.
      type: number
      view:
        value:
          function: getInternalCommentCount
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-comment-date-custom-field
      name: Flowzira Last Comment Date
      description: The date of the last comment on the issue.
      type: datetime
      view:
        value:
          function: getLastCommentDate
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-first-comment-date-custom-field
      name: Flowzira First Comment Date
      description: The date of the first comment on the issue.
      type: datetime
      view:
        value:
          function: getFirstCommentDate
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-commenter-name-custom-field
      name: Flowzira Last Commenter
      description: The last person to comment on the issue.
      type: string
      view:
        value:
          function: getLastCommenter
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-commenter-is-assignee-custom-field
      name: Flowzira Last Commenter is Assignee
      description: Whether the last commenter is the assignee.
      type: string
      view:
        value:
          function: isLastCommenterAssignee
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-commenter-is-reporter
      name: Flowzira Last Commenter is Reporter
      description: Whether the last commenter is the reporter.
      type: string
      view:
        value:
          function: isLastCommenterReporter
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-commenter-is-creator-custom-field
      name: Flowzira Last Commenter is Creator
      description: Whether the last commenter is the creator.
      type: string
      view:
        value:
          function: isLastCommenterCreator
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-assignee-comment-date-custom-field
      name: Flowzira Last Assignee Comment Date
      description: The date of the last comment by the assignee.
      type: datetime
      view:
        value:
          function: getLastAssigneeCommDate
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-first-comment-custom-field
      name: Flowzira First Comment
      description: The first comment on the issue.
      type: string
      view:
        value:
          function: getFirstComment
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-first-commenter-name-custom-field
      name: Flowzira First Commenter
      description: The person who made the first comment.
      type: string
      view:
        value:
          function: getFirstCommenter
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-first-commenter-is-assignee-custom-field
      name: Flowzira First Commenter is Assignee
      description: Whether the first commenter is the assignee.
      type: string
      view:
        value:
          function: isFirstCommAssignee
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-first-commenter-is-reporter-custom-field
      name: Flowzira First Commenter is Reporter
      description: Whether the first commenter is the reporter.
      type: string
      view:
        value:
          function: isFirstCommReporter
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-first-commenter-is-creator-custom-field
      name: Flowzira First Commenter is Creator
      description: Whether the first commenter is the creator.
      type: string
      view:
        value:
          function: isFirstCommenterCreator
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-public-comment-count
      name: Flowzira Public Comment Count
      description: The number of public comments on the issue
      type: number
      view:
        value:
          function: getPublicCommentCount
        resource: generic_view
        render: native
        experience:
          - issue-view
      icon: resource:assets;Flowzira_cf_preview.svg
    - key: flowzira-agent-reply-count
      name: Flowzira Agent Reply Count
      description: The number of replies from agents on the issue
      type: number
      view:
        value:
          function: getAgentReplyCount
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-customer-reply-count
      name: Flowzira Customer Reply Count
      description: The number of replies from customers on the issue
      type: number
      view:
        value:
          function: getCustomerReplyCount
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-commenter-is-customer
      name: Flowzira Last Commenter is Customer
      description: Whether the last commenter on the issue is a customer
      type: string
      view:
        value:
          function: isLastCommenterCustomer
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-comment-is-internal
      name: Flowzira Last Comment is Internal
      description: Whether the last comment on the issue is internal
      type: string
      view:
        value:
          function: isLastCommentInternal
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-comment-is-agent-response
      name: Flowzira Last Comment is Agent Response
      description: Whether the last comment on the issue is a response from an agent
      type: string
      view:
        value:
          function: isLastCommentAgent
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-agent-response-date
      name: Flowzira Last Agent Response Date
      description: The date of the last response from an agent on the issue
      type: datetime
      view:
        value:
          function: getLastAgentDate
        resource: generic_view
        render: native
        experience:
          - issue-view
    - key: flowzira-last-customer-comment-date
      name: Flowzira Last Customer Comment Date
      description: The date of the last comment from a customer on the issue
      type: datetime
      view:
        value:
          function: getLastCustomerDate
        resource: generic_view
        render: native
        experience:
          - issue-view
  consumer:
    - key: flowzira-sync-queue-consumer
      queue: flowzira-sync-queue
      resolver:
        function: syncQueueConsumer
        method: event-listener
  function:
    - key: syncQueueConsumer
      handler: resolvers/admin-handler.adminHandler
      timeoutSeconds: 600
    - key: get-last-comment
      handler: get-comment.getLastComment
    - key: getCommentCount
      handler: get-comment.getCommentCount
    - key: getInternalCommentCount
      handler: get-comment.getInternalCommentCount
    - key: getLastCommentDate
      handler: get-comment.getLastCommentDate
    - key: getFirstCommentDate
      handler: get-comment.getFirstCommentDate
    - key: getLastCommenter
      handler: get-comment.getLastCommenter
    - key: isLastCommenterAssignee
      handler: get-comment.isLastCommenterAssignee
    - key: isLastCommenterReporter
      handler: get-comment.isLastCommenterReporter
    - key: isLastCommenterCreator
      handler: get-comment.isLastCommenterCreator
    - key: getLastAssigneeCommDate
      handler: get-comment.getLastAssigneeCommentDate
    - key: getFirstComment
      handler: get-comment.getFirstComment
    - key: getFirstCommenter
      handler: get-comment.getFirstCommenter
    - key: isFirstCommAssignee
      handler: get-comment.isFirstCommenterAssignee
    - key: isFirstCommReporter
      handler: get-comment.isFirstCommenterReporter
    - key: isFirstCommenterCreator
      handler: get-comment.isFirstCommenterCreator
    - key: getPublicCommentCount
      handler: get-jsm-comment.getPublicCommentCount
    - key: getAgentReplyCount
      handler: get-jsm-comment.getAgentReplyCount
    - key: getCustomerReplyCount
      handler: get-jsm-comment.getCustomerReplyCount
    - key: isLastCommenterCustomer
      handler: get-jsm-comment.isLastCommenterCustomer
    - key: isLastCommentInternal
      handler: get-jsm-comment.isLastCommentInternal
    - key: isLastCommentAgent
      handler: get-jsm-comment.isLastCommentAgentResponse
    - key: getLastAgentDate
      handler: get-jsm-comment.getLastAgentResponseDate
    - key: getLastCustomerDate
      handler: get-jsm-comment.getLastCustomerCommentDate
    - key: handleAdminActions
      handler: resolvers/admin-handler.adminHandler
    - key: handelEvent
      handler: event-handler.run
  jira:adminPage:
    - key: flowzira-admin
      resource: admin_view
      resolver:
        function: handleAdminActions
      render: native
      title: Flowzira Settings
      icon: resource:assets;Flowzira_logo_80.svg
    - key: flowzira-getting-started
      resource: getting_started_view
      render: native
      title: Getting Started
      icon: resource:assets;Flowzira_logo_80.svg
      useAsGetStarted: true
  jira:projectSettingsPage:
    - key: flowzira-project-admin
      resource: project_admin_view
      resolver:
        function: handleAdminActions
      render: native
      title: Flowzira Settings
      icon: resource:assets;Flowzira_logo_80.svg
resources:
  - key: generic_view
    path: src/frontend/genericView.jsx
  - key: admin_view
    path: src/frontend/admin.jsx
  - key: project_admin_view
    path: src/frontend/project_admin.jsx
  - key: getting_started_view
    path: src/frontend/getting-started.jsx
  - key: assets
    path: src/flowzira_resources/images
app:
  runtime:
    name: nodejs22.x
  id: ari:cloud:ecosystem::app/2968fde4-bd59-470a-9c31-7eef7a1320c4
permissions:
  content:
    styles:
      - unsafe-inline
    scripts:
      - unsafe-inline
      - unsafe-eval
  scopes:
    - write:jira-work
    - storage:app
    - read:servicedesk-request
    - read:jira-work
    - read:jira-user
    - read:field:jira
    - manage:jira-configuration
